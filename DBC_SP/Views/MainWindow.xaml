<Window x:Class="DBC_SP.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DBC_SP"
        mc:Ignorable="d"
        Title="Správa skladu IT (MVVM)" Height="600" Width="950"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Horní lišta (Tlačítka) -->
            <RowDefinition Height="*"/>
            <!-- Hlavní obsah (Záložky) -->
        </Grid.RowDefinitions>

        <!-- HORNÍ OVLÁDACÍ PANEL -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <!-- Tlačítka používají Command (MVVM) -->
            <Button Content="💾 Uložit VŠE do DB" Command="{Binding SaveCommand}" Width="150" Height="30" Margin="0,0,10,0" Background="#DDFFDD" FontWeight="Bold"/>
            <Button Content="🔄 Obnovit data" Command="{Binding ReloadCommand}" Width="120" Height="30" Margin="0,0,10,0"/>

            <Button Content="💀 Smazat CELOU DB" Command="{Binding DeleteAllCommand}" Width="150" Height="30" Background="#FF4444" Foreground="White" FontWeight="Bold"/>
        </StackPanel>

        <!-- ZÁLOŽKY PRO JEDNOTLIVÉ TABULKY -->
        <TabControl Grid.Row="1">

            <!-- 1. ZÁLOŽKA: NOTEBOOKY -->
            <TabItem Header="💻 Notebooky">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Button Content="+ Přidat Notebook" Command="{Binding AddNotebookCommand}" Width="120" Margin="0,0,10,0"/>
                        <Button Content="🗑 Smazat vybraný" Command="{Binding DeleteNotebookCommand}" Width="120" Background="#FFDDDD"/>
                    </StackPanel>

                    <DataGrid x:Name="NotebookGrid" 
                              Grid.Row="1"
                              ItemsSource="{Binding Notebooky}"
                              SelectedItem="{Binding VybranyNotebook}"
                              AutoGenerateColumns="True"
                              CanUserAddRows="False"/>
                </Grid>
            </TabItem>

            <!-- 2. ZÁLOŽKA: UŽIVATELÉ -->
            <TabItem Header="busts_in_silhouette Uživatelé">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Button Content="+ Přidat Uživatele" Command="{Binding AddUzivatelCommand}" Width="120" Margin="0,0,10,0"/>
                        <Button Content="🗑 Smazat vybraného" Command="{Binding DeleteUzivatelCommand}" Width="125" Background="#FFDDDD"/>
                    </StackPanel>

                    <DataGrid x:Name="UzivatelGrid"
                              Grid.Row="1"
                              ItemsSource="{Binding Uzivatele}"
                              SelectedItem="{Binding VybranyUzivatel}"
                              AutoGenerateColumns="True"
                              CanUserAddRows="False"/>
                </Grid>
            </TabItem>

            <!-- 3. ZÁLOŽKA: OBJEDNÁVKY -->
            <TabItem Header="📦 Objednávky">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Button Content="+ Nová Objednávka" Command="{Binding AddObjednavkaCommand}" Width="130" Margin="0,0,10,0"/>
                        <Button Content="🗑 Smazat objednávku" Command="{Binding DeleteObjednavkaCommand}" Width="140" Background="#FFDDDD"/>
                    </StackPanel>

                    <!-- Zde máme ručně definované sloupce pro hezčí vzhled -->
                    <DataGrid x:Name="ObjednavkaGrid"
                              Grid.Row="1"
                              ItemsSource="{Binding Objednavky}"
                              SelectedItem="{Binding VybranaObjednavka}"
                              AutoGenerateColumns="False" 
                              CanUserAddRows="False"
                              SelectionMode="Single">
                        <DataGrid.Columns>
                            <!-- ID Objednávky -->
                            <DataGridTextColumn Header="ID" Binding="{Binding IDObjednavky}" Width="80"/>

                            <!-- Datum -->
                            <DataGridTextColumn Header="Datum" Binding="{Binding DatumObjdenavky, StringFormat=dd.MM.yyyy HH:mm}" Width="120"/>

                            <!-- Zákazník (použije se ToString z modelu) -->
                            <DataGridTextColumn Header="Zákazník" Binding="{Binding Uzivatel}" Width="150"/>

                            <!-- Notebook (použije se ToString z modelu) -->
                            <DataGridTextColumn Header="Notebook" Binding="{Binding Notebook}" Width="250"/>

                            <!-- Cena s DPH a znakem Kč -->
                            <DataGridTextColumn Header="Cena s DPH" Binding="{Binding CenaSDPH, StringFormat={}{0:N2} Kč}" Width="120" FontWeight="Bold"/>

                            <!-- IČO -->
                            <DataGridTextColumn Header="IČO (nepovinné)" Binding="{Binding ICO}" Width="120"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

        </TabControl>
    </Grid>
</Window>